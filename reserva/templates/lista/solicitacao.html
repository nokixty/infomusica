{% extends 'modelo.html' %}
{% load static %}

{% block titulo %}
<title>Solicitações</title>
{% endblock %}

{% block conteudo %}
<div class="container my-3">
    <h1>Lista de Solicitações</h1>
    
    <hr>
    <div class="row">
        <div class="col-md-12">
            <div class="row d-flex align-items-center">

                <div class="col-md-4">
                <!-- FILTRO -->
                    <div class="form-floating">
                    <select class="form-select " id="floatingSelect" aria-label="Select Menu" onchange="window.location.href=this.value;" style="width: 200px;">
                        <option selected> </option>
                        <option value="?filtro_data=todas" {% if 'todas' in request.GET.filtro_data|default:'' %}selected{% endif %}>
                            Todas</option>
                        <option value="?filtro_data=ultima_semana" {% if 'ultima_semana' in request.GET.filtro_data %}selected{% endif %}>
                            Última semana</option>
                        <option value="?filtro_data=ultimo_mes" {% if 'ultimo_mes' in request.GET.filtro_data %}selected{% endif %}>
                            Último mês</option>
                    </select>
                    <label for="floatingSelect">FILTRO</label>
                    </div>  
                </div>

                <div class="col-md-4">
                    <!-- SOLICITAÇÃO CREATE  -->
                    <a href="{% url 'criar-solicitacao' %}" class="btn btn-secondary"> 
                        <strong>NOVA SOLICITAÇÃO - OLD</strong></a>
                </div>

                <div class="col-md-4">
                    <!-- AJAX -->
                    <button type="button" class="btn btn-secondary js-create" data-url="{% url 'js-criar' %}">
                        <strong>NOVA SOLICITAÇÃO - AJAX</strong></button>
                    <div class="modal fade" id="modal-evento">
                        <div class="modal-dialog modal-dialog-centered">
                            <div class="modal-content">
                                
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <hr>
    
    {% for group in request.user.groups.all %}
    {% if group.name == 'Admin' %}

    <!-- ADM TABLE -->
    <div class="table-responsive">
        <table class="table table-striped table-dark table-hover table-borderless">
            <thead class="text-uppercase">
                <th>Usuario</th>
                <th>Matricula</th>
                <th>Status</th>
                <th>Justificativa</th>
                <th>Data</th>
                <th>Hora</th>
                <th>Postado em</th>
                <th>Opções</th>
            </thead>
            
            <tbody>
                {% include 'lista/adm-parcial-list.html' %}    
            </tbody>
            
        </table>
    </div>

    {% else %}

    <!-- USER TABLE -->
    <div class="table-responsive">
        <table id="table-evento" class="table table-striped table-dark table-hover table-borderless">
            <thead class="text-uppercase">
                <th>Status</th>
                <th>Justificativa</th>
                <th>Data</th>
                <th>Hora</th>
                <th>Opções</th>
            </thead>
            
            <tbody>
                {%  include 'lista/parcial-list.html'  %}    
            </tbody>
        </table>
    </div>

    {% endif %}
    {% endfor %}
    
    <!-- PAGINAÇÃO -->
    <nav aria-label="Page navigation example">
        <ul class="pagination justify-content-center">

        <!-- PRIMEIRA -->
            {% if page_obj.number != 1 %}
            <li class="page-item">
                <a class="page-link text-white bg-dark" href="?page=1"><i class="fa-solid fa-angles-left"></i></a>
            {%else%}

            {%endif%}
            </li>
        
        <!-- PÁGINA ANTERIOR -->
            {% if page_obj.has_previous %}  
            <li class="page-item">
                <a class="page-link text-white bg-dark" href="?page={{ page_obj.previous_page_number }}">ANTERIOR</a>
            {%else%}
            <li class="page-item disabled">
                <a class="page-link text-ligth bg-dark" href="#">ANTERIOR</a>
            {%endif%}
            </li>

        <!-- PÁGINA ATUAL -->
          <li class="page-item disabled">
            <div class="page-link current text-white bg-dark">
                PÁGINA {{ page_obj.number }} / {{ page_obj.paginator.num_pages }}</div></li>

        <!-- PROXIMA PAGINA -->
            {% if page_obj.has_next %}
            <li class="page-item">
                <a class="page-link text-white bg-dark" href="?page={{ page_obj.next_page_number }}">PRÓXIMA</a>
            {%else%}
            <li class="page-item disabled">
                <a class="page-link text-ligth bg-dark" href="#">PRÓXIMA</a>
            {%endif%}
            </li>

            <!-- ULTIMA -->
            {% if page_obj.number != page_obj.paginator.num_pages %}
            <li class="page-item">
                <a class="page-link text-white bg-dark" href="?page={{ page_obj.paginator.num_pages }}"><i class="fa-solid fa-angles-right"></i></a>
            {%else%}

            {%endif%}
            </li>
        </ul>
      </nav>
    
</div>
{% endblock %}

{% block script %}
<script src="{% static 'js/evento.js' %}"></script>
{% endblock %}
